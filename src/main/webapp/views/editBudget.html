
<div class="row">
	<div class="col-lg-12 head-margin"><br><br>
		<ul class="breadcrumb breadgrum-margin">
			<li><a data-ui-sref="dashboard.home">Home</a></li>
			<li><a data-ui-sref="dashboard.capexReg">CAPEX Budget Registration </a></li>
		</ul>
		<h1 class="page-header no-margin">CAPEX Budget Registration</h1>
	</div>
</div>
	<div class="row">
		<form class="form-horizontal" name="userform">
			<div class="col-lg-12">
				<div class="panel panel-primary">
					<div class="panel-heading">CAPEX Budget Registration</div>
					<div class="panel-body">
						<div class="form-group">
							<label class="inline control-label col-xs-2">Capex Requisition No*</label>
							<div class="col-xs-3">
								<input type="text" class="form-control"  data-ng-model="budget.id" disabled>
   							</div>
							<label class="inline control-label col-xs-2">Capex Requisition Date*</label>
							<div class="col-xs-3">
								<input type="text" class="form-control" data-ng-model="budget.date" disabled>
							</div>
						</div>
 						<div class="form-group">
							<label class="control-label col-xs-2">Unit*</label>
							<div class="col-xs-3">
								<select class="form-control" data-ng-model="budget.unitMaster.id" data-ng-options="unit.id as unit.name for unit in units">
								 	<option value="">Select </option>
								</select> 		
							</div>
							<label class="control-label col-xs-2">Department*</label>
							<div class="col-xs-3">
								<select class="form-control" data-ng-model="budget.department.id "data-ng-options="dept.id as dept.name for dept in departments" >
								 	<option value="">Select </option>
								</select> 		
							</div>
						</div>
						
						<div class="form-group">
							<label class="control-label col-xs-2">Sub Division*</label>
							<div class="col-xs-3">
								 <input type="text" class="form-control" data-ng-model="budget.unitMaster.subDivisionMaster.name" disabled>
 							</div>
							<label class="control-label col-xs-2">Sub Division ID*</label>
							<div class="col-xs-3">
								<input type="text" class="form-control" data-ng-model="budget.unitMaster.subDivisionMaster.subDivisionId" disabled>
							</div>
						</div>
						 						<div class="form-group">
							<label class="control-label col-xs-2">Division*</label>
							<div class="col-xs-3">
							<input type="text" class="form-control" data-ng-model="budget.unitMaster.subDivisionMaster.divisionMaster.name" disabled>
 							</div>
							<label class="control-label col-xs-2">Division ID*</label>
							<div class="col-xs-3">
								<input type="text" class="form-control" data-ng-model="budget.unitMaster.subDivisionMaster.divisionMaster.divisionId" disabled>
							</div>
						</div>
						
 						<div class="form-group">
							<label class="control-label col-xs-2">Capex to be incured by*</label>
							<div class="col-xs-3">
								 <input type="text" class="form-control" data-ng-model="budget.unitMaster.subDivisionMaster.divisionMaster.companyMaster.name" disabled>
  							</div>
							<label class="control-label col-xs-2">Company ID*</label>
							<div class="col-xs-3">
								<input type="text" class="form-control" data-ng-model="budget.unitMaster.subDivisionMaster.divisionMaster.companyMaster.companyId" disabled>
							</div>
						</div>
 					<div class="panel-footer">
						<div class="form-group">
							<label class="control-label col-xs-2">Location*</label>
							<div class="col-xs-3">
							<input type="text" class="form-control" data-ng-model="budget.unitLocations.locations.name" disabled>
 							</div>
							<label class="control-label col-xs-2">Location Name*</label>
 							<div class="col-xs-3">
								<input type="text" class="form-control" data-ng-model="budget.unitLocations.locationName.name" disabled>
							</div>
						</div>
  						<div class="form-group">
 							<label class="control-label col-xs-2">Asset Class*</label>
							<div class="col-xs-3">
								<select class="form-control" data-ng-change="assetClassChange()"  data-ng-model="assetClass" data-ng-options="asset.id as asset.name for asset in assetClasses" >
								 	<option value="">Select </option>
								</select> 		
								
							</div>							
							<label class="control-label col-xs-2">Asset Type*</label>
							<div class="col-xs-3">
								<select class="form-control" data-ng-model="assetCategory" data-ng-options="assetCat.id as assetCat.name for assetCat in selectedAssets" >
								 	<option value="">Select </option>
								</select> 		
							</div>
						</div>
						<div class="row">
								<div class="col-lg-12">
									<div class="panel panel-default">
 										<div class="panel-body">
											<div class="form-group">
												<label class="control-label col-xs-3">Financial Year*</label>
												<div class="col-xs-3">
													<select class="form-control" data-ng-model="form1.year" >
														<option value="">Select </option>
														<option value="1">2017-18</option>
														<option value="2">2018-19</option>
												
													</select> 		
												</div>
												<label class="control-label col-xs-2">Quarter*</label>
												<div class="col-xs-3">
													<select class="form-control" data-ng-model="form1.quarter" >
														<option value="">Select </option>
														<option value="1">Jan-Mar Q1</option>
														<option value="2">Apr-Jun Q2</option>
														<option value="3">Jul-Sep Q3</option>
														<option value="4">Oct-Dec Q4</option>
													</select> 		
												</div>
											</div>
											<div class="form-group">
												<label class="control-label col-xs-1">Qty*</label>
												<div class="col-xs-2">
													<input type="number" class="form-control" data-ng-model="form1.qty" >
												</div>
												<label class="control-label col-xs-1">Rate(per unit)*</label>
												<div class="col-xs-2">
													<input type="number" class="form-control" data-ng-model="form1.rate" >
												</div>
 												<label class="control-label col-xs-2">UOM*</label>
												<div class="col-xs-2">
 													<select class="form-control" data-ng-model="form1.uom" data-ng-change="uomChange()" data-ng-options="uom.id as uom.name for uom in uoms" >
													 	<option value="">Select </option>
													</select> 		
 												</div>
  											</div>
 											<div class="form-group">
												<label class="control-label col-xs-1">Cost*</label>
												<div class="col-xs-2" style="margin-top : 7px">
												<label>:		{{form1.rate*form1.qty}} </label>
												</div>
												<label class="control-label col-xs-1" >Taxes*</label>
												<div class="col-xs-2">
													<input type="number" class="form-control" data-ng-model="form1.tax" >
												</div>
 												<label class="control-label col-xs-3">Total Cost including Tax*</label>
												<div class="col-xs-2" style="margin-top : 7px">
													<label>:		{{(form1.rate*form1.qty)+(form1.rate*form1.qty*form1.tax)/100}} </label>
												</div>
  											</div>
  											<div class="form-group">
												<label class="control-label col-xs-2">Description*</label>
												<div class="col-xs-4">
					 								<textarea rows="3" cols="50" class="form-control"data-ng-model="form1.description" placeholder="Description(max 255 Characters)" required></textarea>
  												</div>
												<label class="control-label col-xs-2">Justification*</label>
												<div class="col-xs-4">
					 								<textarea rows="3" cols="50" class="form-control"data-ng-model="form1.justification" placeholder="Justification(max 255 Characters)" required></textarea>
  												</div>
											</div>
  											
  											
										<div class="panel-body">
 												<button type="button" class="btn btn-primary pull-right save-btn" data-ng-click="yearly()">Yearly</button>
 												<button type="button" class="btn btn-primary pull-right save-btn" data-ng-click="addQuarter()">Add</button> 												
										</div>
 									
 									</div>
 										
 								</div>
 							</div>
   							<div class="row">
								<div class="col-lg-12">
									<div class="panel panel-default">
 											<div class="table-responsive">
												 <table class="table table-striped table-bordered">
													<thead>
														<tr>
															<th width="9%">Asset Class</th>
															<th width="9%">Asset Type</th>
															<th width="13%">Decsription</th>
															<th width="13%">Justification</th>
 															<th width="7%">Year</th>															
															<th width="7%">Month</th>
															<th width="5%">Qty</th>
															<th width="7%">Cost</th>
															<th width="6%">Rate</th>
															<th width="4%">UOM</th>
															<th width="5%">Tax</th>
															<th width="8%">Total Cost</th>
															<th width="7%">Actions</th>
 												 		</tr>
													</thead>
													<tbody>
													<tr data-ng-repeat="quarter in budget.quarters">
															<td>{{quarter.assetClassMaster.name}}</td>
															<td>{{quarter.assetCategoriesMaster.name}}</td>
															<td data-ng-if="form.quarter!=quarter">{{quarter.description}}</td>
															<td data-ng-if="form.quarter==quarter">
																<textarea data-ng-model="form.description" class="form-control" data-ng-change="setUnsave()" rows="2"></textarea>
															</td>
															<td data-ng-if="form.quarter!=quarter">{{quarter.justification}}</td>
															<td data-ng-if="form.quarter==quarter">
																<textarea data-ng-model="form.justification" class="form-control" data-ng-change="setUnsave()" rows="2"></textarea>
															</td>
 															<td>{{years[quarter.year]}}</td>
															<td>{{quartersList[quarter.quarter]}}</td>															
															<td data-ng-if="form.quarter!=quarter">{{quarter.qty}}</td>
															<td data-ng-if="form.quarter==quarter">
																<input data-ng-model="form.qty" data-ng-change="quarterEditRateChange()" data-ng-change="setUnsave()" class="form-control" >
															</td>
 															<td data-ng-if="form.quarter!=quarter">{{quarter.cost}}</td>
															<td data-ng-if="form.quarter==quarter">
																<input data-ng-model="form.cost" class="form-control" disabled>
															</td>
 															
															<td data-ng-if="form.quarter!=quarter">{{quarter.rate}}</td>
															<td data-ng-if="form.quarter==quarter">
																<input data-ng-model="form.rate" data-ng-change="quarterEditRateChange();setUnsave()"  class="form-control" >
															</td>
 															<td>{{quarter.uom.name}}</td> 															
															<td data-ng-if="form.quarter!=quarter">{{quarter.tax}}</td>
															<td data-ng-if="form.quarter==quarter">
																<input data-ng-model="form.tax" class="form-control" data-ng-change="quarterEditRateChange();setUnsave()">
															</td>
 															<td data-ng-if="form.quarter!=quarter">{{quarter.total}}</td>
															<td data-ng-if="form.quarter==quarter">
																<input data-ng-model="form.total" class="form-control" disabled>
															</td>
 															
 															<td data-ng-if="form.quarter!=quarter && quarter.quarter>0">
																<button data-ng-click="editQuarter(quarter)" type="button" class="btn btn-xs ink-reaction btn-icon-toggle btn-warning"><i class="fa fa-pencil"></i></button>
																<button data-ng-click="deleteQuarter(quarter)" type="button" class="btn btn-xs ink-reaction btn-icon-toggle btn-danger"><i class="fa fa-trash"></i></button>
															</td>
															<td data-ng-if="form.quarter==quarter" style="margin-top: 3px">
																<button type="button" class="btn btn-xs ink-reaction btn-primary" data-ng-click="updateQuarter(quarter);yearly()"><i class="fa fa-check"></i></button>
																<button type="button" class="btn btn-xs ink-reaction btn-warning" data-ng-click="cancelEditQuarter()"><i class="fa fa-close"></i></button>
															</td>
 														</tr>	
   													</tbody>
												</table>
												</div>
											<!-- /.table-responsive -->
 									</div>
									<!-- /.panel -->
								</div>
								<!-- /.col-lg-6 -->
							</div>
						</div>
						<div class="panel-body">
 							<button type="button" class="btn btn-warning pull-left cancel-btn" data-ui-sref="dashboard.home">Cancel</button>
							<button type="button" class="btn btn-primary pull-right save-btn" data-ng-click="updateBudgetForm()">Request Budget</button>
						<button type="button" class="btn btn-info pull-right save-btn" data-ui-sref="dashboard.home">Save Budget</button>
						
						</div>
					</div>
				</div>
			</div>
			</div>
		</form>
	</div>
 